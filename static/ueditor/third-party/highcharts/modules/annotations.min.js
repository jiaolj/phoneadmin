(function(k,G){function p(a){return"number"===typeof a}function q(a){return a!==H&&null!==a}var H,t,v,w=k.Chart,x=k.extend,D=k.each;v=["path","rect","circle"];t={top:0,left:0,center:.5,middle:.5,bottom:1,right:1};var y=G.inArray,E=k.merge,F=function(){this.init.apply(this,arguments)};F.prototype={init:function(a,d){var c=d.shape&&d.shape.type;this.chart=a;var b,f;f={xAxis:0,yAxis:0,title:{style:{},text:"",x:0,y:0},shape:{params:{stroke:"#000000",fill:"transparent",strokeWidth:2}}};b={circle:{params:{x:0,y:0}}};b[c]&&(f.shape=E(f.shape,b[c]));this.options=E({},f,d)},render:function(a){var d=this.chart,c=this.chart.renderer,b=this.group,f=this.title,e=this.shape,h=this.options,k=h.title,n=h.shape;b||(b=this.group=c.g());!e&&n&&-1!==y(n.type,v)&&(e=this.shape=c[h.shape.type](n.params),e.add(b));!f&&k&&(f=this.title=c.label(k),f.add(b));b.add(d.annotations.group);this.linkObjects();!1!==a&&this.redraw()},redraw:function(){var a=this.options,d=this.chart,c=this.group,b=this.title,f=this.shape,e=this.linkedObject,h=d.xAxis[a.xAxis],z=d.yAxis[a.yAxis],n=a.width,A=a.height,B=t[a.anchorY],C=t[a.anchorX],l,r,g,u;e&&(l=e instanceof k.Point?"point":e instanceof k.Series?"series":null,"point"===l?(a.xValue=e.x,a.yValue=e.y,r=e.series):"series"===l&&(r=e),c.visibility!==r.group.visibility&&c.attr({visibility:r.group.visibility}));e=q(a.xValue)?h.toPixels(a.xValue+h.minPointOffset)-h.minPixelPadding:a.x;l=q(a.yValue)?z.toPixels(a.yValue):a.y;if(!isNaN(e)&&!isNaN(l)&&p(e)&&p(l)){b&&(b.attr(a.title),b.css(a.title.style));if(f){b=x({},a.shape.params);if("values"===a.units){for(g in b)-1<y(g,["width","x"])?b[g]=h.translate(b[g]):-1<y(g,["height","y"])&&(b[g]=z.translate(b[g]));b.width&&(b.width-=h.toPixels(0)-h.left);b.x&&(b.x+=h.minPixelPadding);if("path"===a.shape.type){g=b.d;r=e;for(var v=l,w=g.length,m=0;m<w;)"number"===typeof g[m]&&"number"===typeof g[m+1]?(g[m]=h.toPixels(g[m])-r,g[m+1]=z.toPixels(g[m+1])-v,m+=2):m+=1}}"circle"===a.shape.type&&(b.x+=b.r,b.y+=b.r);f.attr(b)}c.bBox=null;p(n)||(u=c.getBBox(),n=u.width);p(A)||(u||(u=c.getBBox()),A=u.height);p(C)||(C=t.center);p(B)||(B=t.center);e-=n*C;l-=A*B;d.animation&&q(c.translateX)&&q(c.translateY)?c.animate({translateX:e,translateY:l}):c.translate(e,l)}},destroy:function(){var a=this,d=this.chart.annotations.allItems,c=d.indexOf(a);-1<c&&d.splice(c,1);D(["title","shape","group"],function(b){a[b]&&(a[b].destroy(),a[b]=null)});a.group=a.title=a.shape=a.chart=a.options=null},update:function(a,d){x(this.options,a);this.linkObjects();this.render(d)},linkObjects:function(){var a=this.chart,d=this.linkedObject,c=d&&(d.id||d.options.id),b=this.options.linkedTo;q(b)?q(d)&&b===c||(this.linkedObject=a.get(b)):this.linkedObject=null}};x(w.prototype,{annotations:{add:function(a,d){var c=this.allItems,b=this.chart,f,e;"[object Array]"===Object.prototype.toString.call(a)||(a=[a]);for(e=a.length;e--;)f=new F(b,a[e]),c.push(f),f.render(d)},redraw:function(){D(this.allItems,function(a){a.redraw()})}}});w.prototype.callbacks.push(function(a){var d=a.options.annotations,c;c=a.renderer.g("annotations");c.attr({zIndex:7});c.add();a.annotations.allItems=[];a.annotations.chart=a;a.annotations.group=c;"[object Array]"===Object.prototype.toString.call(d)&&0<d.length&&a.annotations.add(a.options.annotations);k.addEvent(a,"redraw",function(){a.annotations.redraw()})})})(Highcharts,HighchartsAdapter);