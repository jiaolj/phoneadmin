define(["jquery","dom"],function(g,m){return function(){var d={},r=function(){var a={},b={};return{getList:function(){var f="",e=[],c=b.page-a.pgl,d=b.page+a.pgr;b.page<=a.pgl+1&&(d=a.pgl+a.pgr+1);d>b.allp+1&&(d=b.allp+1,c=b.allp-6);for(1>c&&(c=1);c<d;c++)e.push(c);g.each(e,function(a,b){f+='\x3ca class\x3d"pg-num" p\x3d"'+b+'"\x3e'+b+"\x3c/a\x3e"});b.dom.html(function(){var a=b.page-1,c=b.page+1;1>a&&(a=1);c>b.allp&&(c=b.allp);return'\x3cdiv class\x3d"jfa-page"\x3e'+'\x3ca p\x3d"1"\x3e\u9996\u9875\x3c/a\x3e\x3ca p\x3d"#pre"\x3e\u4e0a\u4e00\u9875\x3c/a\x3e#pages\x3ca p\x3d"#next"\x3e\u4e0b\u4e00\u9875\x3c/a\x3e\x3ca p\x3d"#allp"\x3e\u5c3e\u9875\x3c/a\x3e'.replace("#pages",f).replace("#allp",b.allp).replace("#pre",a).replace("#next",c)+"\x3c/div\x3e"}).find('a.pg-num[p\x3d"'+b.page+'"]').addClass("active");b.dom.find("a").click(function(){b.page=parseInt(g(this).attr("p"));a.getList();b.suc(b.page)})},state:0,hide:function(){b.dom.addClass("hide")},show:function(){b.dom.removeClass("hide")},empty:function(){b.dom&&(b.dom.empty(),b.dom.removeClass("hide"));a.state=0},init:function(f){a=this;b=f;a.state=1;a.pgl=b.pgl||3;a.pgr=b.pgr||4;b.page=1;b.allp=parseInt((b.count-1)/b.every)+1;1==b.allp?a.empty():a.getList()}}}();g("body").append('\x3cdiv class\x3d"jfa-alert" id\x3d"jfa-alert"\x3e\x3c/div\x3e');var t=g("#jfa-alert"),q;g("body").append('\x3cdiv class\x3d"jfa-cover" id\x3d"jfa-cover"\x3e\x3c/div\x3e');q=g("#jfa-cover");return{html:function(a,b){a.html(b);d.mvvm(a)},state:{0:"1",1:"0"},add:function(a,b){b=parseInt(b||1);var f=parseInt(a.text()),e=parseInt(a.val().trim()),c=parseInt(a.attr("num"));f?a.text(f+b):e?a.val(e+b):c&&a.attr("num",c+b)},msg:{alertMsg:-1},func:function(a){Function.prototype.method=function(a,f){this.prototype[a]=f;return this};Array.method("remove",function(a){a=this.indexOf(a);return 0<=a?(this.splice(a,1),!0):!1});Array.prototype.indexOf||Array.method("indexOf",function(a,f){var e=this.length>>>0,c=Number(f)||0,c=0>c?Math.ceil(c):Math.floor(c);for(0>c&&(c+=e);c<e;c++)if(c in this&&this[c]===a)return c;return-1});String.method("replaceAll",function(a,f){return this.replace(new RegExp(a,"gm"),f)});String.prototype.trim||(String.method("trim",function(){return this.replace(/^\s+|\s+$/g,"")}),String.method("ltrim",function(){return this.replace(/^\s+/g,"")}),String.method("rtrim",function(){return this.replace(/\s+$/g,"")}));a.log=function(a){"undefined"==typeof console?alert(str(a)):console.log(a)};a.str=function(a){return JSON&&JSON.stringify(a)};a.json=function(a){return eval("("+a+")")};a.urlencode=encodeURIComponent},load:function(a,b){g.ajax({url:b,success:function(b){a.html(b)}})},tree:{filter:function(a,b){g.each(a,function(f,e){0==f?b[e]||(b[e]={}):1==f?b[a[0]][e]||(b[a[0]][e]={}):2==f?b[a[0]][a[1]][e]||(b[a[0]][a[1]][e]={}):3==f?b[a[0]][a[1]][a[2]][e]||(b[a[0]][a[1]][a[2]][e]={}):4==f?b[a[0]][a[1]][a[2]][a[3]][e]||(b[a[0]][a[1]][a[2]][a[3]][e]={}):5==f?b[a[0]][a[1]][a[2]][a[3]][a[4]][e]||(b[a[0]][a[1]][a[2]][a[3]][a[4]][e]={}):6==f?b[a[0]][a[1]][a[2]][a[3]][a[4]][a[5]][e]||(b[a[0]][a[1]][a[2]][a[3]][a[4]][a[5]][e]={}):7==f?b[a[0]][a[1]][a[2]][a[3]][a[4]][a[5]][a[6]][e]||(b[a[0]][a[1]][a[2]][a[3]][a[4]][a[5]][a[6]][e]={}):8==f&&(b[a[0]][a[1]][a[2]][a[3]][a[4]][a[5]][a[6]][a[7]][e]||(b[a[0]][a[1]][a[2]][a[3]][a[4]][a[5]][a[6]][a[7]][e]={}))})}},page:r,callback:function(a,b,f,e){setTimeout(function(){a&&d.conf.callback[a]&&d.conf.callback[a](b,f,e)},100)},mvvm:function(a){a.find('[jfa-click\x3d"click"]').each(function(a,b){var c=g(b),h=c.attr("jfa-link"),k=c.attr("jfa-arg")||"kwd";a=c.attr("jfa-callback");var l=function(){a&&d.conf.callback[a]&&d.conf.callback[a](c)};if("sbtn"==a){var n=c.parent().parent().find('input[type\x3d"text"]'),p=function(){c.sval=n.val().trim();l();h&&c.sval&&(location.href=h+"?"+k+"\x3d"+c.sval)};c.click(function(){p()});n.keypress(function(a){13==a.which&&p()})}else c.click(function(){l()})});a.find('[jfa-click\x3d"enter"]').each(function(a,b){var c=g(b),h=g(c.attr("jfa-tar"));a=c.attr("jfa-callback");var k=function(){c.sval=h.val().trim();d.callback(a,c)};c.click(function(){k()});h.keypress(function(a){13==a.which&&k(c)})});a.find('[jfa-click\x3d"active"]').each(function(a,b){var c=g(b),h=c.attr("jfa-tar"),k=c.attr("jfa-to"),l=c.attr("jfa-son"),n=parseInt(c.attr("jfa-prt"))||0,p=c.attr("jfa-repeat");a=c.attr("jfa-callback");(h?c.find(h):c).click(function(){var b=g(this),e=b;if(k)e=g(k);else if(l)e=c.find(l);else if(0<n)for(var m=0;m<n;m++)e=e.parent();p||c.find(h+".active").removeClass("active");e.hasClass("active")?e.removeClass("active"):e.addClass("active");d.callback(a,b)})});a.find('[jfa-click\x3d"change-box"]').each(function(a,b){var c=g(b),h=c.attr("jfa-tar"),k=c.attr("jfa-to"),h=c.find(h);a=c.attr("jfa-callback");h.click(function(b){var e=g(this),h=e.attr("ci");c.find(".active").removeClass("active");e.addClass("active");g("."+k+".active").removeClass("active");g("."+k+'[ci\x3d"'+h+'"]').addClass("active");d.callback(a,e,h,b)})});a.find('[jfa-click\x3d"hide"]').each(function(a,b){var c=g(b),h=c.attr("jfa-tar"),h=g(h),k=c.attr("jfa-to"),l=g(k);a=c.attr("jfa-callback");0==h.length&&(h=c);h.click(function(){l.toggleClass("hide");d.callback(a,l,l.hasClass("hide"))})});var b=function(a,b){if(0<a.length){var c=arguments.callee,d=a.attr("class");return d&&1<d.length&&1<d.split("jfa-nh").length?1:c(a.parent(),b)}};a.click(function(a){b(g(a.target),0)||g(".jfa-hide").addClass("hide")});a.find(".jfa-select").each(function(a,b){var c=g(b);a=c.attr("jfa-callback");c.find("a").click(function(){g(this).parent().find("dl").toggleClass("hide")});c.find("\x3edl\x3edt").click(function(){var b=g(this),c=b.parent(),e=b.text();c.toggleClass("hide");c.parent().find("\x3ea").text(e);d.callback(a,b)})});a.find(".jfa-close").each(function(a,b){var c=g(b),d=c.attr("jfa-tar"),k=g(d);c.click(function(){0==k.length?c.parent().toggleClass("hide"):k.toggleClass("hide")})});a.find('[jfa-click\x3d"jfa-switch"]').each(function(a,b){var c=g(b);c.click(function(){var a=d.state[c.attr("s")],b=c.attr("jfa-callback");c.attr("s",a);d.callback(b,c,a)})})},block:{alert:t,cover:q},tools:{sortByKey:function(a,b){return a.sort(function(a,e){var c=a[b],d=e[b];return c<d?-1:c>d?1:0})},getRequest:function(){var a=window.location.search,b={};if(-1!=a.indexOf("?"))for(strs=a.substr(1).split("\x26"),a=0;a<strs.length;a++)b[strs[a].split("\x3d")[0]]=decodeURI(strs[a].split("\x3d")[1]);return b},alert:function(a,b){b=b||d.tools.alertDefault[a].msg;d.block.alert.show().html(m.alert[a].replace("#msg",b)).css({top:"-"+d.block.alert[0].clientHeight+"px"}).animate({top:d.tools.alertDefault[a].top}).find("a").click(function(){d.tools.alertDefault[a].callback?d.tools.alertDefault[a].callback():d.tools.alertLeave()});d.msg.alertMsg=d.tools.alertDefault[a].leave},alertDefault:{msg:{msg:"\u5f39\u51fa\u6d88\u606f",leave:3,top:"10%"},ok:{msg:"\u6210\u529f\u4fe1\u606f\uff01",leave:3,top:"10%"},warn:{msg:"\u8b66\u544a\u4fe1\u606f\uff01",leave:3,top:"10%"},confirm:{msg:"\u786e\u5b9a\u8981\u5220\u9664\u8be5\u884c\u4fe1\u606f\u5417?",leave:-1,top:"0"}},alertLeave:function(){d.block.alert.animate({top:"-"+d.block.alert[0].clientHeight+"px"},300,function(){g(this).empty().hide();d.block.cover.hide()})},reg:function(a,b){d.block.cover.show();d.block.alert.show().html(m.alert.reg).css({top:"-"+d.block.alert[0].clientHeight+"px"}).animate({top:"10%"},function(){g(this).find('input[name\x3d"username"]').focus()});d.block.alert.find('input[name\x3d"password"]').keypress(function(b){13==b.which&&a&&a()});d.block.alert.find("a.checks").click(function(){a&&a()});d.block.alert.find("a.closes").click(function(){b||d.tools.alertLeave()})},login:function(a,b){d.block.cover.show();d.block.alert.show().html(m.alert.login).css({top:"-"+d.block.alert[0].clientHeight+"px"}).animate({top:"10%"},function(){g(this).find('input[name\x3d"username"]').focus()});d.block.alert.find('input[name\x3d"password"]').keypress(function(b){13==b.which&&a&&a()});d.block.alert.find("a.checks").click(function(){a&&a()});d.block.alert.find("a.closes").click(function(){b||d.tools.alertLeave()})},confirm:function(a,b){d.block.cover.show();""==a&&(a="\u786e\u5b9a\u8981\u5220\u9664\u8be5\u4fe1\u606f\u5417?");d.block.alert.show().html(m.alert.confirm.replace("#msg",a)).css({top:"-"+d.block.alert[0].clientHeight+"px"}).animate({top:"0"}).find("a").click(function(){var a=g(this).attr("rel");d.tools.alertLeave();"callback"==a&&b&&b()})},data:{toDouble:function(a){a+="";1==a.length&&(a="0"+a);return a},arrayRemove:function(a,b){var d=[],e=a.indexOf(b),c;for(c in a)c!=e&&d.push(a[c]);return d}},randomArrayOne:function(a){return a[parseInt(Math.random()*a.length)]},time:{getStrTime:function(a){var b=d.tools.data.toDouble;a=a||{};var f=a.con||"-;-; ;;;".split(";"),e=a.now||new Date;a=e.getFullYear();var c=b(e.getMonth()+1),g=b(e.getDate()),k=b(e.getHours()),l=b(e.getMinutes()),b=b(e.getSeconds()),e="";""!=f[0]&&(e+=a+f[0]);""!=f[1]&&(e+=c+f[1]);""!=f[2]&&(e+=g+f[2]);""!=f[3]&&(e+=k+f[3]);""!=f[4]&&(e+=l+f[4]);""!=f[5]&&(e+=b+f[5]);return e},str_to_int:function(a){return parseInt(((new Date(Date.parse(a.replace(/-/g,"/")))).getTime()+"").substr(0,10))},str_df:function(a,b){var f=d.tools.time.str_to_int;return f(b)-f(a)},add:function(a,b){var f=d.tools.time.int_to_str,e=d.tools.time.str_to_int;return f(e(a)+86400*b)},before:function(a){var b=d.tools.time.getStrTime,f=d.tools.time.add;return f(b(),-1*parseInt(a))},int_to_str:function(a,b){a=parseInt(a);10==(a+"").length&&(a*=1E3);var f=d.tools.data.toDouble,e=new Date(a);back=e.getFullYear()+"-"+f(e.getMonth()+1)+"-"+f(e.getDate());1==b&&(back+=" "+f(e.getHours())+":"+f(e.getMinutes()));return back}}},init:function(a){d=this;d.conf=a||{};d.func(window);d.mvvm(g(document));g(".ie-close").click(function(){g(this).parent().remove()});d.conf.resize&&(d.conf.resize(),g(window).resize(function(){d.conf.resize()}))}}}()});